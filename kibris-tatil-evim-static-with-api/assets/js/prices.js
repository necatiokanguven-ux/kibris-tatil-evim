async function loadPrices(listing){try{const res=await fetch(`/api/airbnb-price?listing=${encodeURIComponent(listing)}`);const data=await res.json();const box=document.querySelector(`[data-prices-box="${listing}"]`);if(!box)return;if(!data||!data.basePrice){box.innerHTML=`<div class="card-body"><strong>Fiyatlar</strong><div style="color:#6b7280;font-size:14px;">Fiyat bilgisi şu anda alınamadı. Lütfen Airbnb sayfasından kontrol edin.</div></div>`;return}const curr=data.currency||'TRY';const fmt=new Intl.NumberFormat('tr-TR',{style:'currency',currency:curr});const base=fmt.format(data.basePrice);const weekend=data.weekendPrice?fmt.format(data.weekendPrice):null;box.innerHTML=`<div class="card-body"><strong>Fiyatlar</strong><div>Hafta içi: ${base} / gece</div>${weekend?`<div>Hafta sonu: ${weekend} / gece</div>`:''}<div style="margin-top:6px;"><a class="btn secondary" href="https://airbnb.com/h/${listing}" target="_blank" rel="noopener">Airbnb'de gör</a></div><div style="color:#6b7280;font-size:12px;margin-top:6px;">Son güncelleme: ${new Date(data.lastUpdated).toLocaleString('tr-TR')}</div></div>`}catch(e){}}
document.addEventListener('DOMContentLoaded',()=>{loadPrices('okanhomes2');loadPrices('okanhomes3')});
